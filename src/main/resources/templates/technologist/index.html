<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="https://www.thymeleaf.org">
<html>
    <head>
        <title>MBI Enterprise</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
        <link rel="stylesheet" type="text/css" media="all" th:href="@{/css/styles.css}">
    </head>

<body>
<div class="container black">
    <div class="documents-container">
        <div class="menu">
            <ul>
                <li name = "addsellTech">Новая технология на продажу</li>
                <li name = "logout">Выйти</li>
            </ul>
        </div>

        <div class="tab">
            <button class="tablinks tablinkbuttons" onclick="openCity(event, 'sellTechnology')">Технологии на продажу</button>
            <button class="tablinks tablinkbuttons" onclick="openCity(event, 'buyTechnology')">Контракты на покупку</button>
            <button class="tablinks tablinkbuttons" onclick="openCity(event, 'marketTechnology')">Межгалоктический рынок</button>
            <button id="deffault" class="tablinks tablinkbuttons" onclick="openCity(event, 'distributeTechnology')">Распределение технологий</button>
        </div>

        <div id="sellTechnology" class="tabcontent">
            <div class="search-form">
                <form class="form search" th:object="${findSellTechnologyDocument}" th:action="@{/technologistIndex}" method="post">
                    <div class="inline-block">
                        <div class="header">
                            Технология:
                        </div>
                        <select th:field="*{idTechnology}" >
                            <option value="0"> -- </option>
                            <option th:each="technology : ${technologys}"  th:value="${technology.technologyId}"  th:utext="${technology.name}"/>
                        </select>
                    </div>
                    <div class="label">
                        Покупатель:
                    </div>
                    <select th:field="*{idAlien}" >
                        <option value="0"> -- </option>
                        <option th:each="alien : ${aliens}"  th:value="${alien.passportId}"  th:utext="${alien.name}"/>
                    </select>
                    <div class="inline-block">
                        <div class="header">
                            Вид сделки:
                        </div>
                        <select th:field="*{idTypeContract}" >
                            <option value="0"> -- </option>
                            <option th:each="typeContract : ${typeContracts}"  th:value="${typeContract.typeContractId}"  th:utext="${typeContract.type}"/>
                        </select>
                    </div>
                    <div class="inline-block">
                        <div class="header">
                            Ключевые слова:
                        </div>
                        <input th:field="*{description}" type="text" class="field" />
                        <input type="submit" class="field" value="Поиск" />
                    </div>
                </form>
            </div>
            <div class="content">
                <table border="1" width="100%">
                    <tr>
                        <th>Технология</th>
                        <th>Покупатель</th>
                        <th>Вид сделки</th>
                        <th>Описание</th>
                        <th></th>
                    </tr>
                    <!-- FOR aliens PRINT -->
                    <tr th:each="sellTechnologyDocument : ${sellTechnologyDocuments}">
                        <td th:utext="${sellTechnologyDocument.technologyName}"></td>
                        <td th:utext="${sellTechnologyDocument.alienName}"></td>
                        <td th:utext="${sellTechnologyDocument.typeContractName}"></td>
                        <td th:utext="${sellTechnologyDocument.description}"></td>
                        <td>
                            <button button name = "editsellTech" th:data1="${sellTechnologyDocument.costForOne}" th:data2="${sellTechnologyDocument.description}" th:onmouseup="|getSellTechnology(${sellTechnologyDocument.sellTechnologyDocumentId}, ${sellTechnologyDocument.idTechnology}, this.getAttribute('data1'), ${sellTechnologyDocument.count}, ${sellTechnologyDocument.idTypeContract}, ${sellTechnologyDocument.idAlien}, this.getAttribute('data2'));|" class = "button-edit">Редактировать</button>
                            <button name = "deleteselltech" th:onmouseup="|getIdByButton(${sellTechnologyDocument.sellTechnologyDocumentId});|"  class = "button-edit" >Удалить</button>
                        </td>
                    </tr>
                    <!-- END FOR -->
                </table>
            </div>
        </div>

        <div id="buyTechnology" class="tabcontent">
            <div class="search-form">
                <form class="form search" th:object="${findBuyTechnologyDocument}" th:action="@{/technologistIndex}" method="post">
                    <div class="inline-block">
                        <div class="header">
                            Технология:
                        </div>
                        <select th:field="*{id}" >
                            <option value="0"> -- </option>
                            <option th:each="alienRace : ${alienRaces}"  th:value="${alienRace.raceId}"  th:utext="${alienRace.name}"/>
                        </select>
                    </div>
                    <div class="inline-block">
                        <div class="header">
                            Раса создатель:
                        </div>
                        <select th:field="*{idRace}" >
                            <option value="0"> -- </option>
                            <option th:each="alienRace : ${alienRaces}"  th:value="${alienRace.raceId}"  th:utext="${alienRace.name}"/>
                        </select>
                    </div>
                    <div class="inline-block">
                        <div class="header">
                            Способ доставки:
                        </div>
                        <select th:field="*{idDeliveryType}" >
                            <option value="0"> -- </option>
                            <option th:each="deliveryType : ${deliveryTypes}"  th:value="${deliveryType.deliveryTypeId}"  th:utext="${deliveryType.type}"/>
                        </select>
                    </div>
                    <div class="inline-block">
                        <div class="header">
                            Ключевые слова:
                        </div>
                        <input th:field="*{description}"  type="text" class="field" />
                        <input type="submit" class="field" value="Поиск" />
                    </div>
                </form>
            </div>
            <div class="content">
                <table border="1" width="100%">
                    <tr>
                        <th>Назначение</th>
                        <th>Раса создатель</th>
                        <th>Доставка</th>
                        <th>Описание</th>
                        <th></th>
                    </tr>
                    <!-- FOR aliens PRINT -->
                    <tr th:each="buyTechnologyMarket : ${buyTechnologyMarkets}">
                        <td th:utext="${buyTechnologyMarket.use}"></td>
                        <td th:utext="${buyTechnologyMarket.raceName}"></td>
                        <td th:utext="${buyTechnologyMarket.deliveryTypeName}"></td>
                        <td th:utext="${buyTechnologyMarket.description}"></td>
                        <td>
                            <button name = "buyTech" class = "button-edit">Купить</button>
                        </td>
                    </tr>
                    <!-- END FOR -->
                </table>
            </div>
        </div>

        <div id="marketTechnology" class="tabcontent">
            <div class="search-form">
                <form class="form search" th:object="${findBuyTechnologyMarket}" th:action="@{/technologistIndex}" method="post">
                    <div class="inline-block">
                        <div class="header">
                            Назначение:
                        </div>
                        <input th:field="*{use}" class="field" type="text" placeholder="Введите..." />
                    </div>
                    <div class="inline-block">
                        <div class="header">
                            Раса создатель:
                        </div>
                        <select th:field="*{idRace}" >
                            <option value="0"> -- </option>
                            <option th:each="alienRace : ${alienRaces}"  th:value="${alienRace.raceId}"  th:utext="${alienRace.name}"/>
                        </select>
                    </div>
                    <div class="inline-block">
                        <div class="header">
                            Способ доставки:
                        </div>
                        <select th:field="*{idDeliveryType}" >
                            <option value="0"> -- </option>
                            <option th:each="deliveryType : ${deliveryTypes}"  th:value="${deliveryType.deliveryTypeId}"  th:utext="${deliveryType.type}"/>
                        </select>
                    </div>
                    <div class="inline-block">
                        <div class="header">
                            Ключевые слова:
                        </div>
                        <input th:field="*{description}"  type="text" class="field" />
                        <input type="submit" class="field" value="Поиск" />
                    </div>
                </form>
            </div>
            <div class="content">
                <table border="1" width="100%">
                    <tr>
                        <th>Назначение</th>
                        <th>Раса создатель</th>
                        <th>Доставка</th>
                        <th>Описание</th>
                        <th></th>
                    </tr>
                    <!-- FOR aliens PRINT -->
                    <tr th:each="buyTechnologyMarket : ${buyTechnologyMarkets}">
                        <td th:utext="${buyTechnologyMarket.use}"></td>
                        <td th:utext="${buyTechnologyMarket.raceName}"></td>
                        <td th:utext="${buyTechnologyMarket.deliveryTypeName}"></td>
                        <td th:utext="${buyTechnologyMarket.description}"></td>
                        <td>
                            <button name = "buyTech" class = "button-edit">Купить</button>
                        </td>
                    </tr>
                    <!-- END FOR -->
                </table>
            </div>
        </div>

        <div id="distributeTechnology" class="tabcontent">
            <div class="search-form">
                <form class="form search">
                    <div class="label">
                        Имя агента:
                    </div>
                    <input name="field_1" class="field" type="text" placeholder="Введите..." />
                    <div class="inline-block">
                        <div class="header">
                            Должность:
                        </div>
                        <select name="crit_2" class="field">
                            <option value="reptioid">Рептилоид</option>
                            <option value="humanoid">Гуманоид</option>
                            <option value="daedra">Даэдра</option>
                        </select>
                    </div>
                    <div class="inline-block">
                        <div class="header">
                            Куратор:
                        </div>
                        <select name="crit_2" class="field">
                            <option value="reptioid">Рептилоид</option>
                            <option value="humanoid">Гуманоид</option>
                            <option value="daedra">Даэдра</option>
                        </select>
                    </div>
                    <div class="inline-block">
                        <div class="header">
                            Ключевые слова:
                        </div>
                        <input name="keywords" type="text" class="field" />
                        <input type="submit" class="field" value="Поиск" />
                    </div>
                </form>
            </div>
            <div class="content">
                <table border="1" width="100%">
                    <tr>
                        <th>Имя агента</th>
                        <th>Должность</th>
                        <th>Куратор</th>
                        <th>Описание</th>
                        <th></th>
                    </tr>
                    <!-- FOR aliens PRINT -->
                    <tr>
                        <td>Зеленый</td>
                        <td>Рожки</td>
                        <td>Рептилоид</td>
                        <td>Не женат</td>
                        <td>
                            <button name = "distributeTech" class = "button-edit">Посмотреть снарежение</button>
                        </td>
                    </tr>
                    <!-- END FOR -->
                </table>
            </div>
        </div>
    </div>

    <div id="addsellTech-modal" class="modal">
        <form class="modal-content form sellTech" th:object="${addSellTechnologyDocument}" th:action="@{/addSellTechnologyDocument}" method="post">
            <table>
                <tr>
                    <td colspan="2" align="center">
                        <div class="header">Договор о продаже технологии</div>
                    </td>
                </tr>
                <tr>
                    <td class="col-1">
                        <div class="label">Технология:</div>
                    </td>
                    <td class="col-2">
                        <select th:field="*{idTechnology}" class="field">
                            <option th:each="technology : ${technologys}"  th:value="${technology.technologyId}"  th:utext="${technology.name}"/>
                        </select>
                    </td>
                </tr>
                <tr>
                    <td class="col-1">
                        <div class="label">Цена за штуку:</div>
                    </td>
                    <td class="col-2">
                        <input th:field="*{costForOne}" class="field" type="text" placeholder="Введите..." />
                    </td>
                </tr>
                <tr>
                    <td class="col-1">
                        <div class="label">Колличиство:</div>
                    </td>
                    <td class="col-2">
                        <input th:field="*{count}" class="field" type="text" placeholder="Введите..." />
                    </td>
                </tr>
                </tr>
                <tr>
                    <td class="col-1">
                        <div class="label">Вид сделки:</div>
                    </td>
                    <td class="col-2">
                        <select th:field="*{idTypeContract}" class="field">
                            <option th:each="typeContract : ${typeContracts}"  th:value="${typeContract.typeContractId}"  th:utext="${typeContract.type}"/>
                        </select>
                    </td>
                </tr>
                <tr>
                    <td class="col-1">
                        <div class="label">Покупатель:</div>
                    </td>
                    <td class="col-2">
                        <select th:field="*{idAlien}" class="field">
                            <option th:each="alien : ${aliens}"  th:value="${alien.passportId}"  th:utext="${alien.name}"/>
                        </select>
                    </td>
                </tr>
                <tr>
                    <td colspan="2">
                        <div class="label">Описание:</div>
                    </td>
                </tr>
                <tr>
                    <td colspan="2">
                        <textarea th:field="*{description}" class="textarea"></textarea>
                    </td>
                </tr>
                <tr>
                    <td align="left">
                        <input type="button" class="close" value="К документам">
                    </td>
                    <td align="right">
                        <input type="submit" value="Создать" />
                    </td>
                </tr>
            </table>
        </form>
    </div>

    <div id="editsellTech-modal" class="modal">
        <form class="modal-content form sellTech" method="POST" th:object="${addSellTechnologyDocument}" th:action="@{/updateSellTechnologyDocument}">
            <table>
                <tr>
                    <td colspan="2" align="center">
                        <div class="header">Договор о продаже технологии</div>
                    </td>
                    <td>
                        <input id="sellTechnologyId" th:field="*{sellTechnologyDocumentId}" class="field" type="hidden" placeholder="Введите..." />
                    </td>
                </tr>
                <tr>
                    <td class="col-1">
                        <div class="label">Технология:</div>
                    </td>
                    <td class="col-2">
                        <select th:field="*{idTechnology}" id="sellTechnologyIdTechnology" class="field">
                            <option th:each="technology : ${technologys}"  th:value="${technology.technologyId}"  th:utext="${technology.name}"/>
                        </select>
                    </td>
                </tr>
                <tr>
                    <td class="col-1">
                        <div class="label">Цена за штуку:</div>
                    </td>
                    <td class="col-2">
                        <input id="sellTechnologyCostForOne" th:field="*{costForOne}" class="field" type="text" placeholder="Введите..." />
                    </td>
                </tr>
                <tr>
                    <td class="col-1">
                        <div class="label">Колличиство:</div>
                    </td>
                    <td class="col-2">
                        <input id="sellTechnologyCount" th:field="*{count}" class="field" type="text" placeholder="Введите..." />
                    </td>
                </tr>
                <tr>
                    <td class="col-1">
                        <div class="label">Вид сделки:</div>
                    </td>
                    <td class="col-2">
                        <select th:field="*{idTypeContract}" id="sellTechnologyIdTypeContract" class="field">
                            <option th:each="typeContracts : ${typeContracts}"  th:value="${typeContracts.typeContractId}"  th:utext="${typeContracts.type}"/>
                        </select>
                    </td>
                </tr>
                <tr>
                    <td class="col-1">
                        <div class="label">Покупатель:</div>
                    </td>
                    <td class="col-2">
                        <select th:field="*{idAlien}" id="sellTechnologyIdAlien" class="field">
                            <option th:each="alien : ${aliens}"  th:value="${alien.passportId}"  th:utext="${alien.name}"/>
                        </select>
                    </td>
                </tr>
                <tr>
                    <td colspan="2">
                        <div class="label">Описание:</div>
                    </td>
                </tr>
                <tr>
                    <td colspan="2">
                        <textarea id="sellTechnologyDescription" th:field="*{description}" class="textarea"></textarea>
                    </td>
                </tr>
                <tr>
                    <td align="left">
                        <input type="button" class="close" value="К документам">
                    </td>
                    <td align="right">
                        <input type="submit" value="Сохранить" />
                    </td>
                </tr>
            </table>
        </form>
    </div>

    <div id="buyTech-modal" class="modal">
        <form class="modal-content form buyTech" method="POST" action="restcontroller.asdaasd">
            <table>
                <tr>
                    <td colspan="2" align="center">
                        <div class="header">Договор о покупке технологии</div>
                    </td>
                </tr>
                <tr>
                    <td class="col-1">
                        <div class="label">Технология:</div>
                    </td>
                    <td class="col-2">
                        <select name="crit_1" class="field">
                            <option value="reptioid">Рептилоид</option>
                            <option value="humanoid">Гуманоид</option>
                            <option value="daedra">Даэдра</option>
                        </select>
                    </td>
                </tr>
                <tr>
                    <td class="col-1">
                        <div class="label">Колличество:</div>
                    </td>
                    <td class="col-2">
                        <select name="crit_1" class="field">
                            <option value="reptioid">Рептилоид</option>
                            <option value="humanoid">Гуманоид</option>
                            <option value="daedra">Даэдра</option>
                        </select>
                    </td>
                </tr>
                <tr>
                    <td class="col-1">
                        <div class="label">Способ доставки:</div>
                    </td>
                    <td class="col-2">
                        <select name="crit_1" class="field">
                            <option value="reptioid">Рептилоид</option>
                            <option value="humanoid">Гуманоид</option>
                            <option value="daedra">Даэдра</option>
                        </select>
                    </td>
                </tr>
                <tr>
                    <td class="col-1">
                        <div class="label">Способ оплаты:</div>
                    </td>
                    <td class="col-2">
                        <select name="crit_1" class="field">
                            <option value="reptioid">Рептилоид</option>
                            <option value="humanoid">Гуманоид</option>
                            <option value="daedra">Даэдра</option>
                        </select>
                    </td>
                </tr>
                </tr>
                <tr>
                    <td colspan="2">
                        <div class="label">Описание:</div>
                    </td>
                </tr>
                <tr>
                    <td colspan="2">
                        <textarea name="description" class="textarea"></textarea>
                    </td>
                </tr>
                <tr>
                    <td align="left">
                        <input type="button" class="close" value="К документам">
                    </td>
                    <td align="right">
                        <input type="submit" value="Сохранить" />
                    </td>
                </tr>
            </table>
        </form>
    </div>


    <div id="logout-modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <form class="form" method="POST" action="/logout">
                <table width=100%>
                    <tr>
                        <td align="center" colspan="3">
                            <h4>Вы действительно хотите выйти?</h4>
                        </td>
                    </tr>
                    <tr>
                        <td width=50%><input class="w-100" type="submit" value="Ok" /></td>
                        <td width=50%><input class="w-100 close" type="button" value="Отмена" /></td>
                    </tr>
                </table>
            </form>
        </div>
    </div>

    <div id="deleteselltech-modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <form class="form" method="POST" th:object="${addSellTechnologyDocument}" th:action="@{/deleteSellTechnologyDocument}">
                <table width=100%>
                    <tr>
                        <td align="center" colspan="3">
                            <h4>Вы действительно хотите удалить запись?</h4>
                        </td>
                    </tr>
                    <tr>
                        <td width=0%><input id="sellTechnologyDocumentIdDelete" th:field="*{sellTechnologyDocumentId}" class="field" type="hidden" placeholder="Введите..." /></td>
                        <td width=50%><input class="w-100" type="submit" value="Ок" /></td>
                        <td width=50%><input class="w-100 close" type="button" value="Отмена" /></td>
                    </tr>
                </table>
            </form>
        </div>
    </div>

    <script>
        function getIdByButton(id) {
            document.getElementById("sellTechnologyDocumentIdDelete").value = id;
        }

        function getSellTechnology(sellTechnologyDocumentId, idTechnology, costForOne, count, idTypeContract, idAlien, description) {
            document.getElementById("sellTechnologyId").value = sellTechnologyDocumentId;
            document.getElementById("sellTechnologyIdTechnology").value = idTechnology;
            document.getElementById("sellTechnologyCostForOne").value = costForOne;
            document.getElementById("sellTechnologyCount").value = count;
            document.getElementById("sellTechnologyIdTypeContract").value = idTypeContract;
            document.getElementById("sellTechnologyIdAlien").value = idAlien;
            document.getElementById("sellTechnologyDescription").value = description;
        }

        function closeModal(modal) {
            modal.style.display = "none";
        }

        let modal_ids = ["logout-modal", "addsellTech-modal", "editsellTech-modal", "deleteselltech-modal", "buyTech-modal"];
        let modal_btn_names = ["logout", "addsellTech", "editsellTech", "deleteselltech", "buyTech"];
        let modals = [];

        for (let id of modal_ids) {
            let modal = document.getElementById(id);
            modals.push(modal);
            let btns = modal.querySelectorAll(".close");
            for (let btn of btns) {
                btn.onclick = function () { closeModal(modal); }
            }
        }

        for (let id of modal_btn_names) {
            let btns = document.getElementsByName(id);
            for(let btn of btns) {
                btn.onclick = function () {
                    document.getElementById(id+"-modal").style.display = "block";
                }
            }
        }

        window.onclick = function (event) {
            for (let modal of modals) {
                if (event.target == modal) {
                    event.target.style.display = "none";
                }
            }
        }
    </script>

    <script>
        document.getElementById("deffault").click();

        function openCity(evt, cityName) {
            // Declare all variables
            var i, tabcontent, tablinks;

            // Get all elements with class="tabcontent" and hide them
            tabcontent = document.getElementsByClassName("tabcontent");
            for (i = 0; i < tabcontent.length; i++) {
                tabcontent[i].style.display = "none";
            }

            // Get all elements with class="tablinks" and remove the class "active"
            tablinks = document.getElementsByClassName("tablinks");
            for (i = 0; i < tablinks.length; i++) {
                tablinks[i].className = tablinks[i].className.replace(" active", "");
            }

            // Show the current tab, and add an "active" class to the button that opened the tab
            document.getElementById(cityName).style.display = "block";
            evt.currentTarget.className += " active";
        }

    </script>
</body>
</html>